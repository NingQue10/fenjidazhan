<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <style>
            *{
                margin: 0;
                padding: 0;
                background: grey;
            }
            #canvas{
                background: white;
                position: absolute;
                margin:auto;          /*将四周边距都设为auto自动*/
                left: 0;              /*离包含元素的距离均设为零*/
                right: 0;
                top: 0;
                bottom: 0;
            }
            #mark{
                width: 200px;
                height: 100px;
                background: yellow;
                position: absolute;
            }
            #res{
                width: 200px;
                height: 200px;
                position: absolute;
                left: 50%;
                top:50%;
                margin-left: -100px;
                margin-top: -100px;
                background: rgba(0,0,0,.5);
                color: #fff;
                z-index: 999;
                border-radius:50%;
                display: none;
                text-align: center;
            }
            #res p{
                line-height: 200px;
            }
            #res h2{
                text-align: center;
                padding: 5px 0;
            }
        </style>
    </head>
    <body>
        <canvas id="canvas" width="800" height="400"></canvas>
            <div class="mark" id="mark"></div>
            <div class="res" id="res">
                <h2>得分:100</h2>
            </div>
    </body>
    <script>
        var canvas= document.getElementById('canvas');
        var context= canvas.getContext('2d');
        //鸟
        var img= new Image();
        img.src='img/bird_up.png';
        var birdX=200;
        var birdY=100;
        var birdTimer=null;
        img.onload=function(){//等待图片加载结束，绘制图片
          if(birdTimer==null){
              birdTimer=setInterval(function () {
              if(birdY<canvas.offsetHeight-img.height){
                birdY++
              }
              context.clearRect(0,0,800,400);
              drawColumn();
              context.drawImage(img,birdX,birdY);
            },10)
          }
        }
        document.onmousedown=function () {
          img.src='img/bird_down.png';
          birdY=birdY-30;
        }
        document.onmouseup=function () {
          img.src='img/bird_up.png';
        }
        //柱子
        var columnArr=[];
        var columnTimer=null;
        function createColumn () {
          columnTimer=setInterval(function () {
            var column={};//柱子容器
            column.positionX=800;
            column.positionY=-Math.round(Math.random()*100+100);
            column.imgA = new Image();
            column.imgB= new Image();
            column.imgA.src='img/pipe_revese.png';
            column.imgB.src='img/pipe_yes.png';
            column.id = new Date().getTime();
            columnArr.push(column);
          },1500)
        }
        createColumn();
        var same=null;
        var mark=0;
        function drawColumn () {
          for(var i=0;i<columnArr.length;i++){
            columnArr[i].positionX--;
            context.drawImage(columnArr[i].imgA,columnArr[i].positionX,columnArr[i].positionY);
            context.drawImage(columnArr[i].imgB,columnArr[i].positionX,columnArr[i].positionY+350);
            if(birdX+img.width>=columnArr[i].positionX&&birdX-columnArr[i].imgA.width<=columnArr[i].positionX){
              if(columnArr[i].id!=same){
                //得分
                mark++;
                same=columnArr[i].id;
                document.getElementById('mark').innerHTML='得分:'+mark;
              }
              //判定碰撞
              if(birdY<columnArr[i].positionY+columnArr[i].imgA.height||birdY+img.height>columnArr[i].positionY+350){
                clearInterval(columnTimer);
                clearInterval(birdTimer);
                var oRes=document.getElementById('res');
                oRes.style.display='block';
                oRes.innerHTML='最终得分'+mark;
              }
              setTimeout(function () {
                oRes.innerHTML='<p>游戏即将重新开始</p>';
                setTimeout(function () {
                  location.reload();
                },3000)
              },3000)
            }
          }
        }
    </script>
</html>